<script>
// מזהה הגיליון
const sheetId = "14tuI-XR1uSI6_NKlVJCSitgrBN8ItKB_kl4b3KwWwp4";

// --- גיליון השמות והכיתות ---
const namesSheet = "Students"; // שנה לשם המדויק
const urlNames = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=${Data}`;
let dataRows = [];

// --- גיליון האירועים ---
const eventsSheet = "Events"; // שנה לשם המדויק
const urlEvents = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=${אירוע}`;
let eventRows = [];

// קריאת שמות וכיתות
fetch(urlNames)
  .then(res => res.text())
  .then(data => {
    const json = JSON.parse(data.substr(47).slice(0, -2));
    dataRows = json.table.rows;
    const nameList = document.getElementById("nameList");
    dataRows.forEach(row => {
      if (row.c[0] && row.c[0].v) {
        let option = document.createElement("option");
        option.value = row.c[0].v; // שם בעמודה A
        nameList.appendChild(option);
      }
    });
  });

// קריאת אירועים
fetch(urlEvents)
  .then(res => res.text())
  .then(data => {
    const json = JSON.parse(data.substr(47).slice(0, -2));
    eventRows = json.table.rows;
    // נניח שהאירועים מתחילים בשורה 2
    if (eventRows.length > 1) {
      document.getElementById("event").value = eventRows[1].c[0]?.v || "";
    }
  });

// בחירת שם → מילוי כיתה
document.getElementById("name").addEventListener("input", function() {
    const selectedName = this.value.trim();
    const row = dataRows.find(r => r.c[0] && r.c[0].v.trim() === selectedName);
    if (row) {
        document.getElementById("class").value = row.c[1]?.v || "";
    } else {
        document.getElementById("class").value = "";
    }
});
</script>
